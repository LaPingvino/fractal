<?xml version="1.0" encoding="UTF-8"?>
<interface>
  <template class="ContentRoomDetailsGeneralPage" parent="AdwPreferencesPage">
    <property name="title" translatable="yes">Room Details</property>
    <child>
      <object class="AdwPreferencesGroup">
        <style>
          <class name="room-details-group"/>
        </style>
        <child>
          <object class="EditableAvatar" id="avatar">
            <accessibility>
              <property name="label" translatable="yes">Room Avatar</property>
            </accessibility>
            <binding name="editable">
              <lookup name="can-change-avatar">
                <lookup name="permissions">
                  <lookup name="room">ContentRoomDetailsGeneralPage</lookup>
                </lookup>
              </lookup>
            </binding>
            <binding name="data">
              <lookup name="avatar-data">
                <lookup name="room">ContentRoomDetailsGeneralPage</lookup>
              </lookup>
            </binding>
            <binding name="inhibit-remove">
              <closure type="gboolean" function="invert_boolean">
                <lookup name="has-avatar">
                  <lookup name="room">ContentRoomDetailsGeneralPage</lookup>
                </lookup>
              </closure>
            </binding>
          </object>
        </child>
        <child>
          <object class="GtkBox">
            <property name="spacing">6</property>
            <property name="orientation">vertical</property>
            <child>
              <object class="GtkEntry" id="room_name_entry">
                <property name="sensitive">false</property>
                <property name="activates-default">True</property>
                <property name="xalign">0.5</property>
                <property name="buffer">
                  <object class="GtkEntryBuffer" id="room_name_buffer">
                    <binding name="text">
                      <lookup name="display-name">
                        <lookup name="room">ContentRoomDetailsGeneralPage</lookup>
                      </lookup>
                    </binding>
                  </object>
                </property>
                <style>
                  <class name="room-details-name"/>
                </style>
              </object>
            </child>
            <child>
              <object class="GtkLabel" id="room_topic_label">
                <property name="visible">false</property>
                <property name="margin-top">12</property>
                <property name="label" translatable="yes">Description</property>
                <property name="halign">start</property>
                <style>
                  <class name="dim-label"/>
                  <class name="caption-heading"/>
                </style>
              </object>
            </child>
            <child>
              <object class="CustomEntry" id="room_topic_entry">
                <property name="sensitive">false</property>
                <property name="margin-bottom">18</property>
                <child>
                  <object class="GtkTextView" id="room_topic_text_view">
                    <property name="justification">center</property>
                    <property name="wrap-mode">word-char</property>
                    <property name="accepts-tab">False</property>
                    <property name="top-margin">7</property>
                    <property name="bottom-margin">7</property>
                    <property name="buffer">
                      <object class="GtkTextBuffer" id="room_topic_buffer">
                        <binding name="text">
                          <closure type="gchararray" function="unwrap_string_or_empty">
                            <lookup name="topic">
                              <lookup name="room">ContentRoomDetailsGeneralPage</lookup>
                            </lookup>
                          </closure>
                        </binding>
                      </object>
                    </property>
                  </object>
                </child>
                <style>
                  <class name="room-details-topic"/>
                </style>
              </object>
            </child>
            <child>
              <object class="GtkButton" id="edit_details_btn">
                <property name="can-shrink">true</property>
                <property name="halign">center</property>
                <property name="label" translatable="yes">Edit Details</property>
                <signal name="clicked" handler="edit_details_clicked" swapped="yes"/>
                <style>
                  <class name="pill" />
                </style>
              </object>
            </child>
            <child>
              <object class="LoadingButton" id="save_details_btn">
                <property name="visible" bind-source="ContentRoomDetailsGeneralPage" bind-property="edit-mode-enabled" bind-flags="sync-create"/>
                <property name="halign">center</property>
                <property name="content-label" translatable="yes">Save Details</property>
                <signal name="clicked" handler="save_details_clicked" swapped="yes"/>
                <style>
                  <class name="pill" />
                </style>
              </object>
            </child>
          </object>
        </child>
      </object>
    </child>
    <child>
      <object class="AdwPreferencesGroup">
        <child>
          <object class="ButtonCountRow" id="members_row">
            <property name="icon-name">users-symbolic</property>
            <property name="action-name">details.show-subpage</property>
            <property name="action-target">'members'</property>
          </object>
        </child>
      </object>
    </child>
    <child>
      <object class="AdwPreferencesGroup">
        <child>
          <object class="ButtonCountRow">
            <property name="title" translatable="yes">Media</property>
            <property name="action-name">details.show-subpage</property>
            <property name="action-target">'media-history'</property>
          </object>
        </child>
        <child>
          <object class="ButtonCountRow">
            <property name="title" translatable="yes">Files</property>
            <property name="action-name">details.show-subpage</property>
            <property name="action-target">'file-history'</property>
          </object>
        </child>
        <child>
          <object class="ButtonCountRow">
            <!-- Translators: As in 'Audio file'. -->
            <property name="title" translatable="yes">Audio</property>
            <property name="action-name">details.show-subpage</property>
            <property name="action-target">'audio-history'</property>
          </object>
        </child>
      </object>
    </child>
    <child>
      <object class="AdwPreferencesGroup" id="notifications">
        <property name="title" translatable="yes">Notifications</property>
        <property name="description" translatable="yes">Which messages trigger notifications in this room</property>
        <child>
          <object class="CheckLoadingRow" id="notifications_global_row">
            <property name="title" translatable="yes">Use Global Setting</property>
            <property name="action-name">room.set-notifications-setting</property>
            <property name="action-target">'global'</property>
          </object>
        </child>
        <child>
          <object class="CheckLoadingRow" id="notifications_all_row">
            <property name="title" translatable="yes">All Messages</property>
            <property name="action-name">room.set-notifications-setting</property>
            <property name="action-target">'all'</property>
          </object>
        </child>
        <child>
          <object class="CheckLoadingRow" id="notifications_mentions_row">
            <property name="title" translatable="yes">Only Mentions and Keywords</property>
            <property name="action-name">room.set-notifications-setting</property>
            <property name="action-target">'mentions-only'</property>
          </object>
        </child>
        <child>
          <object class="CheckLoadingRow" id="notifications_mute_row">
            <property name="title" translatable="yes">Disable Notifications</property>
            <property name="action-name">room.set-notifications-setting</property>
            <property name="action-target">'mute'</property>
          </object>
        </child>
      </object>
    </child>
    <child>
      <object class="AdwPreferencesGroup" id="addresses_group">
        <property name="title" translatable="yes">Public Addresses</property>
        <child type="header-suffix">
          <object class="GtkButton" id="edit_addresses_button">
            <!-- Translators: In this string, 'Edit' is a verb. -->
            <property name="label" translatable="yes" context="room details">Edit</property>
            <property name="action-name">details.show-subpage</property>
            <property name="action-target">'addresses'</property>
            <accessibility>
              <property name="description" translatable="yes">Edit Public Addresses</property>
            </accessibility>
          </object>
        </child>
        <child>
          <object class="GtkLabel" id="no_addresses_label">
            <property name="wrap">true</property>
            <property name="wrap-mode">word-char</property>
            <property name="xalign">0.0</property>   
            <property name="label" translatable="yes">This room has no public addresses</property>
            <style>
              <class name="dim-label"/>
            </style>
          </object>
        </child>
      </object>
    </child>
    <child>
      <object class="AdwPreferencesGroup" id="visibility_group">
        <property name="title" translatable="yes">Access and Visibility</property>
        <child>
          <object class="ComboLoadingRow" id="join_rule">
            <property name="title" translatable="yes">Who Can Join</property>
            <property name="string-model">
              <object class="GtkStringList">
                <items>
                  <item translatable="yes">Only Invited Users</item>
                  <item translatable="yes">Any Registered User</item>
                </items>
              </object>
            </property>
            <binding name="selected-string">
              <lookup name="display-name">
                <lookup name="join-rule">
                  <lookup name="room">ContentRoomDetailsGeneralPage</lookup>
                </lookup>
              </lookup>
            </binding>
            <signal name="notify::selected-string" handler="set_join_rule" swapped="yes"/>
          </object>
        </child>
        <child>
          <object class="SwitchLoadingRow" id="guest_access">
            <property name="title" translatable="yes">Allow Guests</property>
            <property name="subtitle" translatable="yes">Guests are Matrix users without a registered account</property>
            <signal name="notify::is-active" handler="toggle_guest_access" swapped="true"/>
          </object>
        </child>
        <child>
          <object class="SwitchLoadingRow" id="publish">
            <signal name="notify::is-active" handler="toggle_publish" swapped="true"/>
          </object>
        </child>
        <child>
          <object class="ComboLoadingRow" id="history_visibility">
            <property name="title" translatable="yes">Who Can Read History</property>
            <property name="string-model">
              <object class="GtkStringList">
                <items>
                  <item translatable="yes">Anyone, even if they are not in the room</item>
                  <item translatable="yes">Members only, since this option was selected</item>
                  <item translatable="yes">Members only, since they joined the room</item>
                  <item translatable="yes">Members only, since they were invited</item>
                </items>
              </object>
            </property>
            <signal name="notify::selected-string" handler="set_history_visibility" swapped="yes"/>
          </object>
        </child>
      </object>
    </child>
    <child>
      <object class="AdwPreferencesGroup">
        <property name="title" translatable="yes">Advanced Information</property>
        <child>
          <object class="CopyableRow" id="room_id">
            <property name="title" translatable="yes">Matrix Room ID</property>
            <binding name="subtitle">
              <lookup name="room-id-string">
                <lookup name="room">ContentRoomDetailsGeneralPage</lookup>
              </lookup>
            </binding>
            <property name="main-title">subtitle</property>
            <property name="copy-button-tooltip-text" translatable="yes">Copy Matrix Room ID to Clipboard</property>
            <property name="toast-text" translatable="yes">Matrix room ID copied to clipboard</property>
          </object>
        </child>
        <child>
          <object class="SwitchLoadingRow" id="encryption">
            <property name="title" translatable="yes">Enable Encryption</property>
            <binding name="is-active">
              <lookup name="is-encrypted">
                <lookup name="room">ContentRoomDetailsGeneralPage</lookup>
              </lookup>
            </binding>
            <signal name="notify::is-active" handler="enable_encryption" swapped="true"/>
          </object>
        </child>
        <child>
          <object class="ButtonCountRow" id="permission">
            <property name="title" translatable="yes">Permissions</property>
            <property name="action-name">details.show-subpage</property>
            <property name="action-target">'permissions'</property>
          </object>
        </child>
        <child>
          <object class="AdwActionRow" id="room_version">
            <property name="selectable">False</property>
            <property name="title" translatable="yes">Room Version</property>
            <binding name="subtitle">
              <lookup name="version">
                <lookup name="room">ContentRoomDetailsGeneralPage</lookup>
              </lookup>
            </binding>
            <style>
              <class name="property"/>
            </style>
            <child>
              <object class="LoadingButton" id="upgrade_button">
                <!-- Translators: In this string, 'Upgrade' is a verb, as in 'Upgrade Room'. -->
                <property name="content-label" translatable="yes">Upgrade</property>
                <property name="valign">center</property>
                <signal name="clicked" handler="upgrade" swapped="yes"/>
                <style>
                  <class name="destructive-action"/>
                </style>
              </object>
            </child>
          </object>
        </child>
        <child>
          <object class="AdwActionRow" id="room_federated">
            <property name="selectable">False</property>
            <property name="title" translatable="yes">Federation</property>
            <style>
              <class name="property"/>
            </style>
          </object>
        </child>
      </object>
    </child>
  </template>
</interface>
